{"version":3,"file":"index.js","sources":["../src/js/refs.js","../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const refs = {\n    form: document.querySelector('.form'),\n    input: document.querySelector('input[name=\"search-text\"]'),\n    gallery: document.querySelector('.js-gallery'),\n    loader: document.querySelector('.js-loader'),\n    loadContainer: document.querySelector('.load-container'),\n    button: document.querySelector('button'),\n    loadMoreBtn: document.querySelector('.js-more-button'),\n  };","  import { refs } from './refs.js'\n  import SimpleLightbox from \"simplelightbox\";\n  import \"simplelightbox/dist/simple-lightbox.min.css\";\n  \n  export const lightbox = new SimpleLightbox(\".js-gallery a\", {\n    captions: true,\n    captionsData: \"alt\",\n    captionDelay: 250,\n    captionPosition: \"bottom\"\n  });\n\n  export function createGallery(images, append = false) {\n    const markup = images.map(image => (\n      `<li class=\"gallery-item\">\n      <div class=\"gallery-container\">\n      <div class=\"gallery\">\n        <a class=\"preview\" href=\"${image.largeImageURL}\"><img src=\"${image.webformatURL}\" alt=\"${image.tags}\" title=\"\"/></a>\n    </div>\n\n    <div class=\"description\">\n          <div class=\"sub-descr\">\n          <span class=\"img-descr-title\">Likes</span>\n          <span class=\"img-descr\">${image.likes}</span>\n        </div>\n        <div class=\"sub-descr\">\n          <span class=\"img-descr-title\">Views</span>\n          <span class=\"img-descr\">${image.views}</span>\n        </div>\n        <div class=\"sub-descr\">\n          <span class=\"img-descr-title\">Comments</span>\n          <span class=\"img-descr\">${image.comments}</span>\n        </div>\n        <div class=\"sub-descr\">\n          <span class=\"img-descr-title\">Downloads</span>\n          <span class=\"img-descr\">${image.downloads}</span>\n        </div>\n    </div>\n    </div>\n    </li>`\n\n    )).join('');\n\n    if (append) {\n      refs.gallery.insertAdjacentHTML(\"beforeend\", markup);\n    } else {\n      refs.gallery.innerHTML = markup;\n    };\n    lightbox.refresh();\n  };\n\n\n  export function clearGallery() {\n    refs.gallery.innerHTML = '';\n  };\n\n  export function showLoader() {\n    refs.loader.classList.remove('hidden');\n  };\n\n  export function hideLoader() {\n    refs.loader.classList.add('hidden');\n  };\n\n  export function showLoadMoreButton() {\n    refs.loadMoreBtn.classList.remove('hidden');\n\n  };\n\n  export function hideLoadMoreButton() {\n    refs.loadMoreBtn.classList.add('hidden');\n  };\n\n\n\n\n","import axios from 'axios';\n\n export async function getImagesByQuery(query, currentPage) {\n   try {\n    const result = await axios.get('https://pixabay.com/api/', {\n    params: {\n        key: '53354647-5c23245d0a5319fc788c83675',\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n            per_page: 15,\n            page: currentPage,\n    }\n   });\n   return result.data;\n} catch (error) {\n    console.log(error);\n};\n }; \n\n\n\n\n","import { refs } from './js/refs';\nimport { clearGallery } from './js/render-functions';\nimport { showLoader } from './js/render-functions';\nimport { hideLoader } from './js/render-functions';\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { createGallery } from './js/render-functions';\nimport { showLoadMoreButton } from './js/render-functions';\nimport { hideLoadMoreButton } from './js/render-functions';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst PER_PAGE = 15;\nlet query;\nlet currentPage = 1;\nlet totalPages;\n\nrefs.form.addEventListener('submit', async e => {\n    e.preventDefault();\n\n    refs.input.blur();\n    currentPage = 1;\n    const formData = new FormData(e.target);\n    query = formData.get('search-text').trim();\n\n    if(!query) {\n      iziToast.show({\n        message: `Type something to begin your search.`,\n        color: '#EF4040',\n        messageColor: 'white',\n        position: 'topRight',\n        messageSize: '20',\n        timeout: '2000',\n        theme: 'dark',\n      }); return;\n    } ;\n    showLoader();\n    clearGallery();\n    hideLoadMoreButton();\n\n    try{\n      const result = await getImagesByQuery(query, currentPage);\n      if(!result.hits || result.hits.length === 0) {\n        iziToast.show({\n          message: `Sorry, there are no images matching your search query. Please try again!`,\n          iconUrl: './img/bi_x-octagon.svg',\n          color: '#EF4040',\n          position: 'topRight',\n          messageSize: '20',\n          timeout: '4000',\n          theme: 'dark',\n        }); \n        hideLoader();\n        return;\n      }\n      createGallery(result.hits);\n      totalPages = Math.ceil(result.totalHits / PER_PAGE);\n      handleLoadMoreBtn();\n  \n    } catch {\n      iziToast.show({\n          message: `Something went wrong. Please try again later.`,\n          iconUrl: './img/bi_x-octagon.svg',\n          color: '#EF4040',\n          position: 'topRight',\n          messageSize: '20',\n          timeout: '4000',\n          theme: 'dark',\n        });\n    };\n\n    hideLoader();\n    refs.form.reset();\n  });\n\n\n  refs.loadMoreBtn.addEventListener('click', async () => {\n    showLoader();\n    hideLoadMoreButton();\n    currentPage += 1;\n  \n    try{\n      const result = await getImagesByQuery(query, currentPage);\n      if(!result.hits || result.hits.length === 0) {\n        iziToast.show({\n          message: `Sorry, there are no images matching your search query. Please try again!`,\n          iconUrl: './img/bi_x-octagon.svg',\n          color: '#EF4040',\n          position: 'topRight',\n          messageSize: '20',\n          timeout: '4000',\n          theme: 'dark',\n        });\n      }\n      handleLoadMoreBtn();\n      createGallery(result.hits, true);\n          \n      let elem = refs.gallery.firstElementChild;\n      let rect = elem.getBoundingClientRect();\n      const heightToScroll = rect.height * 2;\n\n      window.scrollBy({\n        top: heightToScroll,\n        behavior: \"smooth\",\n      });\n    } catch {\n      iziToast.show({\n          message: `Something went wrong. Please try again later.`,\n          iconUrl: './img/bi_x-octagon.svg',\n          color: '#EF4040',\n          position: 'topRight',\n          messageSize: '20',\n          timeout: '4000',\n          theme: 'dark',\n        });\n    };\n    hideLoader();\n    refs.form.reset();\n  });\n\n\n  function handleLoadMoreBtn() {\n    if(currentPage < totalPages) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      iziToast.show({\n        message: `We're sorry, but you've reached the end of search results.`,\n        iconUrl: './img/bi_x-octagon.svg',\n        color: 'blue',\n        position: 'topRight',\n        messageSize: '20',\n        timeout: '4000',\n        theme: 'dark',\n      });\n    };\n  };\n\n\n\n\n\n\n\n\n\n\n"],"names":["refs","lightbox","SimpleLightbox","createGallery","images","append","markup","image","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getImagesByQuery","query","currentPage","axios","error","PER_PAGE","totalPages","e","iziToast","result","handleLoadMoreBtn","heightToScroll"],"mappings":"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"}